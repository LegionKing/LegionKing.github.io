<html>
<head>
</head>

<body>
<div>
Application <select id="input_appId">
  <option value="NHANES">NHANES - diabetes</option>
  <option value="AirQuality">Air Quality - PM2.5</option>
</select> |
Case <input id="input_id" type="number" value="7" min="1" max="2000" size="2" maxlength="2"> (1-2000)
Precision <input id="input_precision" type="number" value="1" min="1" max="5" size="2" maxlength="2"> (1-5)
<br/>
Tutorial <select id="input_tutorial">
  <option value="-2">Only Explainer (-2)</option>
  <option value="-1">All (-1)</option>
  <option value="0" selected>None (0)</option>
  <option value="1">Attributes (1)</option>
  <option value="2">Values (2)</option>
  <option value="3">Factors (3)</option>
  <option value="4">Partial Score (4)</option>
  <option value="5">AI Explainer (5)</option>
  <option value="6">AI System (6)</option>
  <option value="7">Diff from y (7)</option>
  <option value="23">Values and Factors (23)</option>
</select> |
Hide Factor <select id="input_hideFactor">
  <option value="-4">Only AI (-4)</option>
  <option value="-3">Edit (-3)</option>
  <option value="-2">All (-2)</option>
  <option value="-1" selected>None (-1)</option>
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
</select>
Edit Values <input id="input_editValues" type="checkbox" /> |
<!--
Domain <select id="input_domainId">
  <option value="0">Domain 1</option>
  <option value="1">Domain 2</option>
	</select>
<br/>
XAI Type <select id="input_xaiType">
  <option value="transferable">Transferable</option>
  <option value="isolated">Isolated XAI</option>
  <option value="none">None</option>
</select> |
-->
Show Prediction <input id="input_showPrediction" type="checkbox" checked />

<div><b>Transferable XAI - Transformation matrix</b></div>
<div>URL: <a id="text_url" href=""></a> <button onclick="copyIframeHtml('interactiveIframe')">Copy Iframe</button> <button onclick="copyUrl('interactiveIframe')">Copy URL</button></div>
<iframe id="interactiveIframe" 
		src="Feature-set-transfer-matrix.html?appId=NHANES&id=7&precision=2&showPrediction=1" 
		width="1280px" height="630px"
		frameBorder="0" scrolling="no"
		></iframe>

</div>
<div><b>Transferable XAI - Domain 1</b></div>
<div>URL: <a id="domain1_text_url" href=""></a> <button onclick="copyIframeHtml('interactiveIframeDomain1')">Copy Iframe</button> <button onclick="copyUrl('interactiveIframeDomain1')">Copy URL</button></div>
<iframe id="interactiveIframeDomain1" 
		src="Feature-set-transfer-matrix.html?appId=NHANES&id=7&precision=2&domainId=0&showPrediction=1&xaiType=transferable" 
		width="1000px" height="310px"
		frameBorder="0" scrolling="no"
		></iframe>

<div><b>Transferable XAI - Domain 2</b></div>
<div>URL: <a id="domain2_text_url" href=""></a> <button onclick="copyIframeHtml('interactiveIframeDomain2')">Copy Iframe</button> <button onclick="copyUrl('interactiveIframeDomain2')">Copy URL</button></div>
<iframe id="interactiveIframeDomain2" 
		src="Feature-set-transfer-matrix.html?appId=NHANES&id=7&precision=2&domainId=1&showPrediction=1&xaiType=transferable" 
		width="1280px" height="310px"
		frameBorder="0" scrolling="no"
		></iframe>

<div><b>Independent - Domain 1</b></div>
<div>URL: <a id="independent1_text_url" href=""></a> <button onclick="copyIframeHtml('interactiveIframeIndependent1')">Copy Iframe</button> <button onclick="copyUrl('interactiveIframeIndependent1')">Copy URL</button></div>
<iframe id="interactiveIframeIndependent1" 
		src="Feature-set-transfer-matrix.html?appId=NHANES&id=7&precision=2&domainId=0&showPrediction=1&xaiType=isolated" 
		width="1280px" height="310px"
		frameBorder="0" scrolling="no"
		></iframe>

<div><b>Independent - Domain 2</b></div>
<div>URL: <a id="independent2_text_url" href=""></a> <button onclick="copyIframeHtml('interactiveIframeIndependent2')">Copy Iframe</button> <button onclick="copyUrl('interactiveIframeIndependent2')">Copy URL</button></div>
<iframe id="interactiveIframeIndependent2" 
		src="Feature-set-transfer-matrix.html?appId=NHANES&id=7&precision=2&domainId=1&showPrediction=1&xaiType=isolated" 
		width="1280px" height="310px"
		frameBorder="0" scrolling="no"
		></iframe>


<script>
let url = "";
const urlRoot = "" // "http://127.0.0.1:5500/";
const htmlNameMatrix = "Feature-set-transfer-matrix.html";
const htmlNamePredict = "Feature-set-transfer-predict.html";
let tutorial = 0;

function updateIframeUrl() {
	const appId = document.querySelector("#input_appId").value;
	const id = document.querySelector("#input_id").value;
	const precision = document.querySelector("#input_precision").value;
	// const domainId = document.querySelector("#input_domainId").value;
	// const xaiType = document.querySelector("#input_xaiType").value;
	const tutorial = document.querySelector("#input_tutorial").value;
	const hideFactor = document.querySelector("#input_hideFactor").value;
	const editValues = document.querySelector("#input_editValues").checked ? 1 : 0;
	const showPrediction = document.querySelector("#input_showPrediction").checked ? 1 : 0;
	

	const iframeDomain1 = document.querySelector("#interactiveIframeDomain1");
	url = htmlNamePredict+"?appId="+appId+"&id="+id+"&precision="+precision+"&domainId=0&showPrediction="+showPrediction+"&xaiType=transferable&tutorial="+tutorial+"&hideFactor="+hideFactor+"&editValues="+editValues;
	iframeDomain1.src = url;
	document.querySelector("#domain1_text_url").href = url;
	document.querySelector("#domain1_text_url").innerHTML = url;

	const iframeDomain2 = document.querySelector("#interactiveIframeDomain2");
	url = htmlNamePredict+"?appId="+appId+"&id="+id+"&precision="+precision+"&domainId=1&showPrediction="+showPrediction+"&xaiType=transferable&tutorial="+tutorial+"&hideFactor="+hideFactor+"&editValues="+editValues;
	iframeDomain2.src = url;
	document.querySelector("#domain2_text_url").href = url;
	document.querySelector("#domain2_text_url").innerHTML = url;

	const iframeIndependent1 = document.querySelector("#interactiveIframeIndependent1");
	url = htmlNamePredict+"?appId="+appId+"&id="+id+"&precision="+precision+"&domainId=0&showPrediction="+showPrediction+"&xaiType=isolated&tutorial="+tutorial+"&hideFactor="+hideFactor+"&editValues="+editValues;
	iframeIndependent1.src = url;
	document.querySelector("#independent1_text_url").href = url;
	document.querySelector("#independent1_text_url").innerHTML = url;

	const iframeIndependent2 = document.querySelector("#interactiveIframeIndependent2");
	url = htmlNamePredict+"?appId="+appId+"&id="+id+"&precision="+precision+"&domainId=1&showPrediction="+showPrediction+"&xaiType=isolated&tutorial="+tutorial+"&hideFactor="+hideFactor+"&editValues="+editValues;
	iframeIndependent2.src = url;
	document.querySelector("#independent2_text_url").href = url;
	document.querySelector("#independent2_text_url").innerHTML = url;

	if (tutorial != 0) { 
		iframeDomain1.height = '350px';
		iframeDomain2.height = '350px';
		iframeIndependent1.height = '350px';
		iframeIndependent2.height = '350px';
	}
	else if ((hideFactor != 0 || xaiType == 'none') && tutorial == 0) { 
		iframeDomain1.height = '320px'; 
		iframeDomain2.height = '320px'; 
		iframeIndependent1.height = '320px'; 
		iframeIndependent2.height = '320px'; 
	}
	else { 
		iframeDomain1.height = '320px'; 
		iframeDomain2.height = '320px'; 
		iframeIndependent1.height = '320px'; 
		iframeIndependent2.height = '320px'; }

	const iframe = document.querySelector("#interactiveIframe");
	url = htmlNameMatrix+"?appId="+appId+"&id="+id+"&precision="+precision+"&tutorial="+tutorial+"&hideFactor="+hideFactor;
	iframe.src = url;
	document.querySelector("#text_url").href = url;
	document.querySelector("#text_url").innerHTML = url;
}

function updateId() {
	const input_id = document.querySelector("#input_id");
	let id = input_id.value;
	id = id < 0 ? 0 : id;
	id = id > 2000 ? 2000 : id;
	input_id.value = id;
	updateIframeUrl();
}
function updateIdTyping(e) {
	const input_id = document.querySelector("#input_id");
	let id = input_id.value;
	
	if (e.key == 'Enter') {
		return;
	}
	else if (isNaN(parseInt(e.key)) || id.toString().length >= 4) { // invalid typing to revert to previous number
		event.preventDefault()
		input_id.value = id; 
	} 
}

function copyIframeHtml(iframeId) {
	let html = document.querySelector("#"+iframeId).outerHTML;
	html = html.replace("src=\"", "src=\"" + urlRoot);
	html = html.replaceAll("&amp;", "&");
	html = html.replaceAll("id=\""+iframeId+"\" ", "");
	navigator.clipboard.writeText(html);
}
function copyUrl(iframeId) {
	navigator.clipboard.writeText(document.querySelector("#"+iframeId).src);
}

document.querySelector("#input_appId").onchange = updateIframeUrl;
document.querySelector("#input_id").onchange = updateId;
document.querySelector("#input_id").onkeypress = updateIdTyping;
document.querySelector("#input_precision").onchange = updateIframeUrl;
// document.querySelector("#input_domainId").onchange = updateIframeUrl;
// document.querySelector("#input_xaiType").onchange = updateIframeUrl;
document.querySelector("#input_tutorial").onchange = updateIframeUrl;
document.querySelector("#input_hideFactor").onchange = updateIframeUrl;
document.querySelector("#input_editValues").onchange = updateIframeUrl;
document.querySelector("#input_showPrediction").onchange = updateIframeUrl;

updateIframeUrl();
</script>

</body>

</html>